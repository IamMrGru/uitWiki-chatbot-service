from typing import Dict

import pandas as pd
from fastapi import APIRouter, HTTPException
from pydantic import BaseModel
from tqdm import tqdm

from app.core.process_pdf_v2 import (get_embedding, process_document,
                                     upsert_vector)
from app.services.pinecone_service import PineconeService

router = APIRouter()
pinecone_service = PineconeService()


class Metadata(BaseModel):
    name: str
    value: str


class UpsertRequest(BaseModel):
    documentId: str
    documentUrl: str
    metadata: Dict[str, str]


test = {
    "response": [
        {
            "PageNumber": 1,
            "ImagePath": "app/static/images/page_1.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\nA. GIỚI THIỆU CHUNG\na. Mục tiêu đào tạo\nĐào tạo nguồn nhân lực công nghệ thông tin có kỹ năng đáp ứng những yêu cầu trong thương mại trực tuyến, tiến hành nghiên cứu khoa học và chuyển giao công nghệ tiên tiến trong CNTT vào thương mại điện tử, đặc biệt là hướng vào các ứng dụng nhằm góp phần đẩy mạnh sự nghiệp công nghiệp hóa, hiện đại hóa đất nước.\n\nMục tiêu đào tạo cụ thể (ký hiệu là G) của chương trình đào tạo:\n\n* G1: Đào tạo nguồn lực chất lượng cao nắm vừng kiến thức cơ bản và chuyên sâu về Thương mại điện tử như các phương pháp phân tích, thiết kế hệ thống kinh doanh trực tuyến, kế toán, tiếp thị, thanh toán điện tử, nền kinh tế điện tử, công nghệ web và mạng xã hội, đặc điểm người sử dụng web, kỹ năng phân tích, tổng hợp, lập giải pháp, phát triển khả năng tư duy, rèn luyện đạo đức, kỹ năng nghề nghiệp.\n* G2: Đào tạo đội ngũ chuyên sâu có khả năng tổ chức và phát triển các ứng dụng tin học hỗ trợ các hoạt động giao dịch điện tử, thương mại, kinh doanh điện tử, chứng thực và an toàn trong giao dịch điện tử.\n* G3: Đào tạo đội ngũ quản lý có khả năng hoạch định, xây dựng và quản lý các hoạt động thương mại điện tử tại doanh nghiệp cũng như tại các cơ quan nhà nước.\n* G4: Đào tạo nguồn nhân lực có phẩm chất chính trị, đạo đức và sức khỏe tốt.\n\nb. Vị trí và khả năng làm việc sau tốt nghiệp\nSinh viên tốt nghiệp có thể làm việc ở những phạm vi và lĩnh vực khác nhau như:\n\n* Chuyên viên quản trị (System Administrator), chuyên viên phát triển (Web Developer, Mobile Developer) các hệ thống giao dịch thương mại, kinh doanh trực tuyến, chịu trách nhiệm phát triển và duy trì trang web / app bán hàng trực tuyến.\n* Chuyên viên tiếp thị trực tuyến (Digital marketing executive): lập kế hoạch, triển khai và theo dõi chiến dịch Marketing trên các kênh Online: Google (SEO/SEM, Ads, GDN, Shopping,...), Facebook, Instagram, Zalo, Tiktok, Cốc Cốc, Forum, Sàn TMĐT...\n* Chuyên viên phân tích nghiệp vụ (Business analyst): tiếp nhận yêu cầu người dùng, phân tích nghiệp vụ từ khách hàng và xây dựng nghiệp vụ chi tiết để các team phát triển, quản trị sự thay đổi của nghiệp vụ. Vị trí này phổ biến tại các công ty chuyên về triển khai các hệ thống kinh doanh trực tuyến, quản trị đơn hàng, CRM, ERP, BPM.\n* Chuyên viên tư vấn (Business consultant): tư vấn, đề xuất giải pháp, xây dựng và bảo trì các dự án công nghệ thông tin liên quan đến lĩnh vực thương mại điện tử hoặc quản trị doanh nghiệp điện tử.\n* Giám đốc kinh doanh trực tuyến: sau khi ra trường và tích lũy kinh nghiệm vài năm, vị trí Giám đốc kinh doanh trực tuyến là điều mà sinh viên có thể nhắm tới và đạt được.\n* Khởi nghiệp kinh doanh trực tuyến: xây dựng kế hoạch kinh doanh để biến ý tưởng thành hiện thực, kiến thức được trang bị ở giảng đường sẽ là lợi thế cho các bạn trẻ khởi nghiệp kinh doanh trực tuyến thành công.\n* Cán bộ giảng dạy, nghiên cứu khoa học và ứng dụng thương mại điện tử ở các trường đại học và cao đẳng trên cả nước.\n\nc. Hình thức và thời gian đào tạo\n- Thời gian đào tạo: 4 năm, 8 học kỳ.\n\nd. Điều kiện tốt nghiệp\n\n* Công nhận tốt nghiệp: Sinh viên đã tích lũy tối thiểu là 126TC, đã hoàn thành các môn học bắt buộc đối với ngành đăng ký tốt nghiệp, trình độ Anh Văn đạt theo quy định của trường.\n* Ngoài ra, sinh viên phải đáp ứng đủ các tiêu chuẩn khác theo Quy chế đào tạo hiện hành của Trường Đại học Công nghệ Thông tin.\n* Sinh viên tốt nghiệp được cấp bằng: Cử nhân ngành Thương mại Điện tử.\n\nB. CHƯƠNG TRÌNH ĐÀO TẠO\n"
        },
        {
            "PageNumber": 2,
            "ImagePath": "app/static/images/page_2.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\n1. CHƯƠNG TRÌNH ĐÀO TẠO\n1.1 Tỷ lệ các khối kiến thức\n- Không kể Giáo dục thể chất, Giáo dục quốc phòng.\n\n\n**BẢN CHÉP LẠI BẢNG:**\n\n| Khối kiến thức | Tổng số tín chỉ | Tỷ lệ (%) |\n|---|---|---|\n| Lý luận chính trị | 11 | 8% |\n| Toán - Khoa học tự nhiên | 14 | 11% |\n| Khối kiến thức giáo dục đại cương (41TC) <br> Ngoại ngữ | 12 | 10% |\n| Giáo dục thể chất - Giáo dục Quốc phòng | - | - |\n| Môn học khác | 4 | 3% |\n| Khối kiến thức giáo dục chuyên nghiệp (73TC) <br> Cơ sở nhóm ngành | 25 | 20% |\n| Cơ sở ngành | 18 | 14% |\n| Chuyên ngành + Tự chọn | 30 | 24% |\n| Thực tập doanh nghiệp | 2 | 2% |\n| Khối kiến thức tốt nghiệp (12TC) <br> Khóa luận tốt nghiệp hoặc 03 môn học chuyên đề tốt nghiệp | 10 | 8% |\n| Tổng số tín chỉ tích lũy tối thiểu toàn khóa | 126 | 100% |\n\n1.2 Khối kiến thức giáo dục đại cương\n- Tổng cộng 41 tín chỉ (không kể Giáo dục thể chất và Giáo dục quốc phòng).\n\n**BẢN CHÉP LẠI BẢNG:**\n\n| STT | Mã môn học | Tên môn học | TC | LT | TH |\n|---|---|---|---|---|---|\n|  |  | Các môn lý luận chính trị | 11 |  |  |\n| 1 | SS003 | Tư tưởng Hồ Chí Minh |  | 2 | 0 |\n| 2 | SS007 | Triết học Mác – Lênin |  | 3 | 0 |\n| 3 | SS008 | Kinh tế chính trị Mác – Lênin |  | 2 | 0 |\n"
        },
        {
            "PageNumber": 3,
            "ImagePath": "app/static/images/page_3.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\n4\tSS009\tChủ nghĩa xã hội khoa học\t2\t2\t0\n5\tSS010\tLịch sử Đảng Cộng sản Việt Nam\t2\t2\t0\nToán – Tin học - Khoa học tự nhiên 14\n6\tMA006\tGiải tích\t4\t4\t0\n7\tMA003\tĐại số tuyến tính\t3\t3\t0\n8\tMA004\tCấu trúc rời rạc\t4\t4\t0\n9\tMA005\tXác suất thống kê\t3\t3\t0\nNgoại ngữ 12\n10\tENG01\tAnh văn 1\t4\t4\t0\n11\tENG02\tAnh văn 2\t4\t4\t0\n12\tENG03\tAnh văn 3\t4\t4\t0\nGiáo dục thể chất – Giáo dục quốc phòng\n13\tPE012\tGiáo dục thể chất\n14\tME001\tGiáo dục quốc phòng\t4\nMôn học khác\n15\tSS004\tKỹ năng nghề nghiệp\t2\t2\t0\n16\tSS006\tPháp luật đại cương\t2\t2\t0\n\n1.3 Khối kiến thức giáo dục chuyên nghiệp\n- Tổng cộng 73 tín chỉ.\n\n1.3.1 Nhóm các môn học cơ sở nhóm ngành\n- Bắt buộc cho tất cả sinh viên trường Đại học Công nghệ thông tin.\nSTT Mã môn học Tên môn học TC LT TH\n\n\n**BẢN CHÉP LẠI BẢNG:**\n\n| STT | Mã môn học | Tên môn học | TC | LT | TH |\n|---|---|---|---|---|---|\n| 4 | SS009 | Chủ nghĩa xã hội khoa học | 2 | 2 | 0 |\n| 5 | SS010 | Lịch sử Đảng Cộng sản Việt Nam | 2 | 2 | 0 |\n| 6 | MA006 | Giải tích | 4 | 4 | 0 |\n| 7 | MA003 | Đại số tuyến tính | 3 | 3 | 0 |\n| 8 | MA004 | Cấu trúc rời rạc | 4 | 4 | 0 |\n| 9 | MA005 | Xác suất thống kê | 3 | 3 | 0 |\n| 10 | ENG01 | Anh văn 1 | 4 | 4 | 0 |\n| 11 | ENG02 | Anh văn 2 | 4 | 4 | 0 |\n| 12 | ENG03 | Anh văn 3 | 4 | 4 | 0 |\n| 13 | PE012 | Giáo dục thể chất |  |  |  |\n| 14 | ME001 | Giáo dục quốc phòng | 4 |  |  |\n| 15 | SS004 | Kỹ năng nghề nghiệp | 2 | 2 | 0 |\n| 16 | SS006 | Pháp luật đại cương | 2 | 2 | 0 |\n\n\nKhông có hình ảnh hoặc biểu đồ nào trong tài liệu đã cung cấp."
        },
        {
            "PageNumber": 4,
            "ImagePath": "app/static/images/page_4.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\n17\tIT001\tNhập môn lập trình\t4\t3\t1\n18\tIT002\tLập trình hướng đối tượng\t4\t3\t1\n19\tIT003\tCấu trúc dữ liệu và giải thuật\t4\t3\t1\n20\tIT004\tCơ sở dữ liệu\t4\t3\t1\n21\tIT005\tNhập môn mạng máy tính\t4\t3\t1\n22\tEC005\tGiới thiệu ngành Thương mại điện tử\t1\t1\t0\n23\tSE104\tNhập môn công nghệ phần mềm\t4\t3\t1\nTổng cộng\t25\t19\t6\n\n1.3.2 Nhóm các môn học cơ sở ngành\n- Các môn học bắt buộc đối với sinh viên ngành Thương mại điện tử.\n\n24\tEC001\tKinh tế học đại cương\t4\t4\t0\n25\tEC003\tTiếp thị căn bản\t3\t3\t0\n26\tEC201\tPhân tích thiết kế quy trình nghiệp vụ doanh nghiệp\t4\t3\t1\n27\tIS334\tThương mại điện tử\t3\t3\t0\n28\tIS207\tPhát triển ứng dụng web\t4\t3\t1\nTổng cộng\t18\t16\t2\n\n1.3.3 Nhóm môn học bắt buộc ngành Thương mại điện tử\n\n29\tEC311\tTiếp thị trực tuyến\t3\t2\t1\n30\tEC312\tThiết kế hệ thống TMĐT\t3\t2\t1\n\n\n**BẢN CHÉP LẠI BẢNG:**\n\n| STT | Mã môn học | Tên môn học | TC | LT | TH |\n|---|---|---|---|---|---|\n| 17 | IT001 | Nhập môn lập trình | 4 | 3 | 1 |\n| 18 | IT002 | Lập trình hướng đối tượng | 4 | 3 | 1 |\n| 19 | IT003 | Cấu trúc dữ liệu và giải thuật | 4 | 3 | 1 |\n| 20 | IT004 | Cơ sở dữ liệu | 4 | 3 | 1 |\n| 21 | IT005 | Nhập môn mạng máy tính | 4 | 3 | 1 |\n| 22 | EC005 | Giới thiệu ngành Thương mại điện tử | 1 | 1 | 0 |\n| 23 | SE104 | Nhập môn công nghệ phần mềm | 4 | 3 | 1 |\n| Tổng cộng |  |  | 25 | 19 | 6 |\n\n| STT | Mã môn học | Tên môn học | TC | LT | TH |\n|---|---|---|---|---|---|\n| 24 | EC001 | Kinh tế học đại cương | 4 | 4 | 0 |\n| 25 | EC003 | Tiếp thị căn bản | 3 | 3 | 0 |\n| 26 | EC201 | Phân tích thiết kế quy trình nghiệp vụ doanh nghiệp | 4 | 3 | 1 |\n| 27 | IS334 | Thương mại điện tử | 3 | 3 | 0 |\n| 28 | IS207 | Phát triển ứng dụng web | 4 | 3 | 1 |\n| Tổng cộng |  |  | 18 | 16 | 2 |\n\n| STT | Mã môn học | Tên môn học | TC | LT | TH |\n|---|---|---|---|---|---|\n| 29 | EC311 | Tiếp thị trực tuyến | 3 | 2 | 1 |\n| 30 | EC312 | Thiết kế hệ thống TMĐT | 3 | 2 | 1 |\n"
        },
        {
            "PageNumber": 5,
            "ImagePath": "app/static/images/page_5.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\n31\tEC213\tQuản trị quan hệ khách hàng và nhà cung cấp\t3\t2\t1\n32\tEC337\tHệ thống thanh toán trực tuyến\t3\t3\t0\n33\tEC208\tQuản trị dự án TMĐT\t3\t3\t0\n34\tEC229\tPháp luật trong TMĐT\t2\t2\t0\n35\tEC335\tAn toàn và bảo mật TMĐT\t3\t3\t0\nTổng cộng\t20\t17\t3\n\n1.3.4 Nhóm các môn tự chọn ngành Thương mại điện tử\nSố tín chỉ tự chọn tích lũy tối thiểu là 10. SV chọn một trong hai cách sau:\n\n- Cách 1: tích lũy tối thiểu 10TC trong danh sách bên dưới\n- Cách 2: tích lũy tối thiểu 3TC trong danh sách bên dưới, tích lũy số tín chỉ còn lại trong các ngành học khác của trường, tổng số tín chỉ tích lũy tối thiểu 10TC\n\nSTT\tMã môn học\tTên môn học\tTC\tLT\tTH\n36\tEC214\tNhập môn quản trị chuỗi cung ứng(*)\t3\t2\t1\n37\tEC331\tQuản trị chiến lược kinh doanh điện tử(*)\t3\t3\t0\n38\tEC332\tQuản trị sản xuất\t3\t3\t0\n39\tEC333\tQuản trị tài chính doanh nghiệp\t3\t3\t0\n40\tEC334\tQuản trị kênh phân phối\t3\t3\t0\n41\tEC338\tQuản trị bán hàng\t3\t3\t0\n42\tEC336\tQuản trị nhân lực\t3\t3\t0\n43\tEC002\tQuản trị doanh nghiệp\t3\t3\t0\n44\tIS210\tHệ quản trị cơ sở dữ liệu\t4\t3\t1\n45\tNT118\tPhát triển ứng dụng trên thiết bị di động(*)\t3\t2\t1\n\n\n**BẢN CHÉP LẠI BẢNG:**\n\n| STT | Mã môn học | Tên môn học | TC | LT | TH |\n|---|---|---|---|---|---|\n| 31 | EC213 | Quản trị quan hệ khách hàng và nhà cung cấp | 3 | 2 | 1 |\n| 32 | EC337 | Hệ thống thanh toán trực tuyến | 3 | 3 | 0 |\n| 33 | EC208 | Quản trị dự án TMĐT | 3 | 3 | 0 |\n| 34 | EC229 | Pháp luật trong TMĐT | 2 | 2 | 0 |\n| 35 | EC335 | An toàn và bảo mật TMĐT | 3 | 3 | 0 |\n|  | Tổng cộng |  | 20 | 17 | 3 |\n| 36 | EC214 | Nhập môn quản trị chuỗi cung ứng(*) | 3 | 2 | 1 |\n| 37 | EC331 | Quản trị chiến lược kinh doanh điện tử(*) | 3 | 3 | 0 |\n| 38 | EC332 | Quản trị sản xuất | 3 | 3 | 0 |\n| 39 | EC333 | Quản trị tài chính doanh nghiệp | 3 | 3 | 0 |\n| 40 | EC334 | Quản trị kênh phân phối | 3 | 3 | 0 |\n| 41 | EC338 | Quản trị bán hàng | 3 | 3 | 0 |\n| 42 | EC336 | Quản trị nhân lực | 3 | 3 | 0 |\n| 43 | EC002 | Quản trị doanh nghiệp | 3 | 3 | 0 |\n| 44 | IS210 | Hệ quản trị cơ sở dữ liệu | 4 | 3 | 1 |\n| 45 | NT118 | Phát triển ứng dụng trên thiết bị di động(*) | 3 | 2 | 1 |\n"
        },
        {
            "PageNumber": 6,
            "ImagePath": "app/static/images/page_6.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\n46 IS336 Hoạch định nguồn lực doanh nghiệp(*) 4 3 1\n47 IS217 Kho dữ liệu và OLAP 3 3 0\n48 IS405 Dữ liệu lớn(*) 4 3 1\n49 IS403 Phân tích dữ liệu kinh doanh(*) 3 3 0\n50 IS353 Mạng xã hội 3 3 0\n51 IS105 Hệ quản trị cơ sở dữ liệu Oracle 4 3 1\n52 IS332 Hệ thống thông tin quản lý 3 3 0\n53 EC232 Nguyên lý kế toán 3 3 0\n54 IS254 Hệ hỗ trợ ra quyết định(*) 3 3 0\n55 IS252 Khai thác dữ liệu(*) 4 3 1\n\n1.4 Khối kiến thức tốt nghiệp\n- Tổng cộng 12 tín chỉ.\n\n1.4.1 Thực tập doanh nghiệp\nSinh viên bắt buộc phải đi thực tập thực tế tại các doanh nghiệp và thực hiện báo cáo thực tập nộp về Khoa.\n- Thực tập doanh nghiệp (EC222): 2 tín chỉ\n\n1.4.2 Khóa luận tốt nghiệp\nSinh viên làm khóa luận tốt nghiệp (10 tín chỉ) hoặc học các môn chuyên đề tốt nghiệp thay thế (tổng cộng số tín chỉ các môn học là 10).\n- Khóa luận tốt nghiệp (EC401): 10 tín chỉ.\n\n1.4.3 Nhóm các môn học chuyên đề tốt nghiệp\nSinh viên học 3 môn chuyên đề tốt nghiệp (10TC) trong danh sách các môn tự chọn có dấu (*) hoặc các môn học do Bộ môn đề nghị bổ sung với định hướng phù hợp cho ngành TMĐT.\n\n2. SƠ ĐỒ MỐI LIÊN HỆ THỨ TỰ MÔN HỌC GIỮA CÁC MÔN\nSinh viên xem thông tin môn học trước, môn học tiên quyết tại https://daa.uit.edu.vn, mục Chương trình đào tạo => Hệ chính quy => Danh mục Môn học Đại học.\n\n3. KẾ HOẠCH GIẢNG DẠY\nGIAI ĐOẠN I: 54 TC\n\n\n**BẢN CHÉP LẠI BẢNG:**\n\n| STT | Mã môn | Tên môn | TC | LT | BT |\n|---|---|---|---|---|---|\n| 46 | IS336 | Hoạch định nguồn lực doanh nghiệp(*) | 4 | 3 | 1 |\n| 47 | IS217 | Kho dữ liệu và OLAP | 3 | 3 | 0 |\n| 48 | IS405 | Dữ liệu lớn(*) | 4 | 3 | 1 |\n| 49 | IS403 | Phân tích dữ liệu kinh doanh(*) | 3 | 3 | 0 |\n| 50 | IS353 | Mạng xã hội | 3 | 3 | 0 |\n| 51 | IS105 | Hệ quản trị cơ sở dữ liệu Oracle | 4 | 3 | 1 |\n| 52 | IS332 | Hệ thống thông tin quản lý | 3 | 3 | 0 |\n| 53 | EC232 | Nguyên lý kế toán | 3 | 3 | 0 |\n| 54 | IS254 | Hệ hỗ trợ ra quyết định(*) | 3 | 3 | 0 |\n| 55 | IS252 | Khai thác dữ liệu(*) | 4 | 3 | 1 |\n"
        },
        {
            "PageNumber": 7,
            "ImagePath": "app/static/images/page_7.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\nMã môn | Tên môn | TC | LT | TH\n------- | -------- | -------- | -------- | --------\nIT001 | Nhập môn lập trình | 4 | 3 | 1\nMA006 | Giải tích | 4 | 4 | 0\nMA003 | Đại số tuyến tính | 3 | 3 | 0\nEC005 | Giới thiệu ngành Thương mại điện tử | 1 | 1 | 0\nENG01 | Anh Văn 1 | 4 | 4 | 0\nPE012 | Giáo dục thể chất |  |  | \nME001 | Giáo dục quốc phòng |  |  | \nTổng số tín chỉ HK1 | 16 | 15 | 1\nIT002 | Lập trình hướng đối tượng | 4 | 3 | 1\nIT003 | Cấu trúc dữ liệu và giải thuật | 4 | 3 | 1\nEC001 | Kinh tế học đại cương | 4 | 4 | 0\nSS004 | Kỹ năng nghề nghiệp | 2 | 2 | 0\nENG02 | Anh Văn 2 | 4 | 4 | 0\nTổng số tín chỉ HK2 | 18 | 16 | 2\nIT004 | Cơ sở dữ liệu | 4 | 3 | 1\nIT005 | Nhập môn mạng máy tính | 4 | 3 | 1\nMA004 | Cấu trúc rời rạc | 4 | 4 | 0\nMA005 | Xác suất thống kê | 3 | 3 | 0\nENG03 | Anh Văn 3 | 4 | 4 | 0\nTổng số tín chỉ HK3 | 19 | 17 | 2\n\n\n**BẢN CHÉP LẠI BẢNG:**\nBảng hiển thị danh sách các môn học theo từng học kỳ, bao gồm mã môn, tên môn, số tín chỉ lý thuyết (TC), số tín chỉ thực hành trên lớp (LT) và số tín chỉ thực hành (TH).  Bảng cũng hiển thị tổng số tín chỉ cho mỗi học kỳ."
        },
        {
            "PageNumber": 8,
            "ImagePath": "app/static/images/page_8.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\nGIAI ĐOẠN II: 73 TC\n\n\n**BẢN CHÉP LẠI BẢNG:**\n\n| Mã môn | Tên môn | TC | LT | TH |\n|---|---|---|---|---|\n| Học kỳ 4 |  |  |  |  |\n| SE104 | Nhập môn công nghệ phần mềm | 4 | 3 | 1 |\n| IS334 | Thương mại điện tử | 3 | 3 | 0 |\n| EC201 | Phân tích thiết kế quy trình nghiệp vụ doanh nghiệp | 4 | 3 | 1 |\n| EC003 | Tiếp thị căn bản | 3 | 3 | 0 |\n| SS009 | Chủ nghĩa xã hội khoa học | 2 | 2 | 0 |\n|  | Tổng số tín chỉ HK4 | 16 | 14 | 2 |\n| Học kỳ 5 |  |  |  |  |\n| IS207 | Phát triển ứng dụng web | 4 | 3 | 1 |\n| EC213 | Quản trị quan hệ khách hàng và nhà cung cấp | 3 | 2 | 1 |\n| SS003 | Tư tưởng Hồ Chí Minh | 2 | 2 | 0 |\n| SS006 | Pháp luật đại cương | 2 | 2 | 0 |\n|  | Tự chọn | 4 | 4 | 0 |\n|  | Tổng số tín chỉ HK5 | 15 | 13 | 2 |\n| Học kỳ 6 |  |  |  |  |\n| EC311 | Tiếp thị trực tuyến | 3 | 2 | 1 |\n| EC312 | Thiết kế hệ thống thương mại điện tử | 3 | 2 | 1 |\n| EC208 | Quản trị dự án TMĐT | 3 | 3 | 0 |\n| EC335 | An toàn và bảo mật TMĐT | 3 | 3 | 0 |\n| SS007 | Triết học Mác - Lênin | 3 | 3 | 0 |\n| | Tự chọn | 3 | 3 | 0 |\n|  | Tổng số tín chỉ HK6 | 18 | 16 | 2 |\n\n\n**MÔ TẢ HÌNH ẢNH HOẶC BIỂU ĐỒ:**\n\nKhông có hình ảnh hoặc biểu đồ nào được cung cấp."
        },
        {
            "PageNumber": 9,
            "ImagePath": "app/static/images/page_9.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\nEC222 Thực tập doanh nghiệp 2 2 0\nEC229 Pháp luật trong thương mại điện tử 2 2 0\nEC337 Hệ thống thanh toán trực tuyến 3 3 0\nHọc kỳ 7 SS008 Kinh tế chính trị Mác - Lênin 2 2 0\nSS010 Lịch sử Đảng Cộng sản Việt Nam 2 2 0\nTự chọn 3 3 0\nTổng số tín chỉ HK7 14 14 0\n\nSinh viên chọn một trong hai hình thức sau:\nHọc kỳ 8 EC401 Khóa luận tốt nghiệp hoặc học 10 tín chỉ cho các môn học thuộc chuyên đề tốt nghiệp. 10 10 0\nTổng số tín chỉ HK8 10 10 0\n\nC. CHẤT LƯỢNG CAO\n1.1 Về cấu trúc nội dung\nChương trình đào tạo chất lượng cao được xây dựng và phát triển trên nền của CTĐT đại trà. Vì vậy, hai chương trình này có cấu trúc nội dung tương tự như nhau.\nSinh viên chương trình chất lượng cao, ngoài việc hoàn thành Anh văn 1, Anh văn 2, Anh văn 3 như chương trình đại trà còn bắt buộc hoàn thành thêm Anh văn 4 và Anh văn 5 theo Quyết định số 547/QĐ-ĐHCNTT về ban hành quy định đào tạo ngoại ngữ đối với hệ đại học chính quy của Trường ĐHCNTT.\n\n1.2 Về tính liên thông với chương trình đại trà\nCác điều kiện và phương thức chuyển đổi cụ thể giữa chương trình chất lượng cao và chương trình đại trà đã được nhà trường ban hành trong Quy định đào tạo chất lượng cao của Trường theo Điều 10 của Quy định về đào tạo chương trình chất lượng cao kèm theo Quyết định số 163/QĐ-ĐHCNTT ngày 4/4/2017. Cụ thể như sau:\n“Sinh viên có thể xin chuyển sang chương trình đại trà trong vòng 04 học kỳ đầu tiên nếu có hoàn cảnh đặc biệt, đồng thời sinh viên có điểm trung bình chung tích lũy (ĐTBTL) tính tới thời điểm xét không dưới 6.5 và có điểm xét tuyển bằng hoặc cao hơn điểm trúng tuyển của chương trình chính quy đại trà tương ứng.\nSinh viên làm đơn xin chuyển chương trình kèm các minh chứng để Ban Giám hiệu xem xét và ra quyết định.\nSinh viên được chuyển ra khỏi chương trình sẽ được bố trí vào lớp chính quy đại trà cùng khóa và thuộc ngành/chuyên ngành tương ứng với ngành đào tạo CLC mà sinh viên đang học.”\n\n\n\n**BẢN CHÉP LẠI BẢNG:**\n\n|  |  |  |  |  |\n|---|---|---|---|---|\n| Học kỳ 7 | EC222 | Thực tập doanh nghiệp | 2 | 2 | 0 |\n|  | EC229 | Pháp luật trong thương mại điện tử | 2 | 2 | 0 |\n|  | EC337 | Hệ thống thanh toán trực tuyến | 3 | 3 | 0 |\n|  | SS008 | Kinh tế chính trị Mác - Lênin | 2 | 2 | 0 |\n|  | SS010 | Lịch sử Đảng Cộng sản Việt Nam | 2 | 2 | 0 |\n|  | Tự chọn |  | 3 | 3 | 0 |\n|  | Tổng số tín chỉ HK7 |  | 14 | 14 | 0 |\n| Học kỳ 8 | EC401 | Khóa luận tốt nghiệp hoặc học 10 tín chỉ cho các môn học thuộc chuyên đề tốt nghiệp. | 10 | 10 | 0 |\n|  | Tổng số tín chỉ HK8 |  | 10 | 10 | 0 |\n\n\n"
        },
        {
            "PageNumber": 10,
            "ImagePath": "app/static/images/page_10.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\nNgoài ra, chuẩn đầu ra ngoại ngữ cao hơn và được quy định tại Điều 5 của Quy định về đào tạo chương trình chất lượng cao theo Quyết định số 163/QĐ-ĐHCNTT ngày 4/4/2017.\n\n1.3 Về mục tiêu, chuẩn đầu ra của chương trình\nChương trình đào tạo chất lượng cao và chương trình đào tạo đại trà của ngành Thương mại điện tử có chuẩn đầu ra và cấu trúc chương trình tương tự nhau nhưng chuẩn đầu ra của chương trình chất lượng cao có trình độ năng lực ngoại ngữ, chuyên môn cao hơn chương trình đại trà nhờ có hệ thống hỗ trợ đặc biệt của Trường cùng với đội ngũ giảng viên lý thuyết có trình độ cao đáp ứng tiêu chuẩn năng lực theo yêu cầu của Bộ GDĐT cho chương trình này và đội ngũ trợ giảng lý thuyết, thực hành.\n\nChuẩn đầu ra về ngoại ngữ của chương trình chất lượng cao cao hơn một bậc so với chương trình đại trà (bậc 4/6 theo đúng quy định tại thông tư 23/TT-BGDĐT), một số chuẩn đầu ra quan trọng về kỹ năng mềm và kỹ năng chuyên môn có mức độ năng lực cao hơn so với chương trình đại trà. Sự khác biệt này đạt được là nhờ những yếu tố sau đây:\n\n- Chương trình đào tạo ngoại ngữ được thiết kế riêng, theo hướng tăng cường số tiết học, học lớp nhỏ ít sinh viên và sinh viên được chia lớp tùy theo từng trình độ nhằm giúp sinh viên dễ dàng đạt được năng lực ngoại ngữ theo yêu cầu cao và tăng cường khả năng tương tác hiệu quả của giảng viên trong giảng dạy ngoại ngữ. Ngoài ra, sinh viên được học một số môn học chuyên ngành bằng ngoại ngữ, điều này sẽ mang lại hiệu quả rõ nét so với chương trình chính quy đại trà.\n- Lớp học chất lượng cao có sĩ số nhỏ giúp cho giảng viên có thể theo sát tình hình học tập của sinh viên. Ngoài ra, lớp học được bố trí trợ giảng để hỗ trợ giảng viên lý thuyết hướng dẫn sinh viên, chấm bài tập trên lớp bên cạnh đội ngũ giảng viên khác hướng dẫn thực hành cho sinh viên. Nhờ vận dụng lý thuyết và thực hành nhiều hơn, kỹ năng chuyên môn của sinh viên chất lượng cao cũng được nâng cao và được theo dõi qua từng giai đoạn của mỗi môn học.\n\nTrường có hệ thống đội ngũ cán bộ phục vụ, hỗ trợ dành cho chương trình này, điều này mang lại hiệu quả cao, giúp chương trình đạt được chuẩn đầu ra như mong đợi. Ngoài giờ lên lớp, sinh viên chương trình chất lượng cao còn được tạo điều kiện tham gia nhiều hoạt động ngoại khóa như: tham quan các công ty, team-building, câu lạc bộ ngoại ngữ, câu lạc bộ năng khiếu, mời các doanh nghiệp về chia sẽ kinh nghiệm phỏng vấn, viết CV, các kỹ năng mềm, kỹ năng chuyên môn... để nâng cao ý thức của sinh viên về nghề nghiệp và kỹ năng mềm.\n\nChuẩn đầu ra của chương trình đào tạo chất lượng cao (CLC) được xây dựng dựa trên các điều khoản sau trong Quy định về đào tạo chất lượng cao trình độ Đại học, được ban hành kèm theo Thông tư số 23/2014/TT-BGDĐT ngày 18/07/2014 của Bộ trưởng Bộ Giáo dục và Đào tạo):\n\n- Điều 5, Mục 2: Chuẩn đầu ra của CTĐT chất lượng cao phải cao hơn của CTĐT đại trà tương ứng về năng lực chuyên môn; năng lực ngoại ngữ; năng lực ứng dụng công nghệ thông tin; năng lực dẫn dắt, chủ trì và làm việc nhóm; khả năng thích nghi với môi trường công tác; riêng năng lực ngoại ngữ tối thiểu phải đạt bậc 4/6 theo khung năng lực ngoại ngữ 6 bậc dùng cho Việt Nam (hoặc tương đương).\n- Điều 12, Mục 3a: Sinh viên chương trình CLC không đủ điều kiện để tiếp tục học tập chương trình CLC theo quy định của cơ sở đào tạo thì phải chuyển sang học CTĐT đại trà hoặc thôi học theo quy định của cơ sở đào tạo.\n- Điều 12, Mục 3b: Sinh viên đang học CTĐT đại trà nếu có nhu cầu và đủ điều kiện theo quy định của cơ sở đào tạo có thể được xem xét tiếp nhận vào học chương trình CLC.\n\nĐể tạo điều kiện cho Sinh viên trong CTĐT đại trà và CTCLC có thể thay đổi CTĐT trong quá trình học (áp dụng Điều 12/Mục 3a/b), Bảng CÐR CTCLC cho ngành Thương mại điện tử được xây dựng như CTĐT chính quy ngành Thương mại điện tử. Tuy nhiên, trình độ năng lực của một số chuẩn đầu ra môn học trong CTĐT CLC sẽ cao hơn so với CTĐT chính quy (áp dụng Điều 5/Mục 2), nhấn mạnh đến yếu tố đạt được mục tiêu về CĐR về ngoại ngữ và thực hành, đặc biệt là các môn học cơ sở ngành, chuyên ngành được giảng dạy bằng tiếng Anh. Những môn học có sự khác biệt với chương trình đại trà được gọi chung là môn học chất lượng cao và được trình bày chi tiết trong mục 2.\n\n\n2. các môn học chất lượng cao\n"
        },
        {
            "PageNumber": 11,
            "ImagePath": "app/static/images/page_11.png",
            "PageText": "**SAO CHÉP VĂN BẢN:**\n\n2.1 Các môn học có sự nâng cao về chuẩn đầu ra\nChuẩn đầu ra của CTĐT chất lượng cao phải cao hơn của CTĐT đại trà tương ứng về năng lực chuyên môn; năng lực ngoại ngữ; năng lực ứng dụng công nghệ thông tin; năng lực dẫn dắt, chủ trì và làm việc nhóm.\n\nChẳng hạn, sự khác biệt này được thể hiện qua một số các kỹ năng cụ thể như sau:\n\n\nKỹ năng | Nội dung\n------- | --------\n1 | Quản lý thông tin\n2 | Xác định và phát biểu bài toán\n3 | Hình thành giả thiết, khảo sát tài liệu, thử nghiệm, kiểm chứng và bảo vệ luận điểm\n4 | Điều hành hoạt động nhóm\n5 | Giao tiếp bằng văn bản (trong đó có tiếng Anh)\n6 | Thuyết trình\n7 | Đọc hiểu tài liệu chuyên ngành bằng ngoại ngữ\n8 | Hiểu nhu cầu, xác định mục tiêu, chức năng, thành phần và kiến trúc của hệ thống\n9 | Mô hình hóa hệ thống\n10 | Quản lý dự án\n11 | Thiết kế, triển khai và tích hợp hệ thống\n\nKỹ năng ngoại ngữ được nâng cao thông qua bổ sung thêm hai môn anh văn trong HK4 và HK5.\n\nCác kỹ năng khác được nâng cao thông qua các môn học sau:\n\n\n**SAO CHÉP BẢNG:**\n\n| STT | Mã môn học | Tên môn học | TC | LT | TH |\n|---|---|---|---|---|---|\n| 1 | ENG04 | Anh văn 4 | 4 | 4 | 0 |\n| 2 | ENG05 | Anh văn 5 | 4 | 4 | 0 |\n| 3 | IS254 | Hệ hỗ trợ ra quyết định | 3 | 3 | 0 |\n"
        },
        {
            "PageNumber": 12,
            "ImagePath": "app/static/images/page_12.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\n4\tIS210\tHệ quản trị CSDL\t4\t3\t1\n5\tIS252\tKhai thác dữ liệu\t4\t3\t1\n6\tNT118\tPhát triển ứng dụng trên thiết bị di động\t3\t2\t1\n7\tIS403\tPhân tích dữ liệu kinh doanh\t3\t3\t0\n8\tIS334\tThương mại điện tử\t3\t3\t0\n9\tEC311\tTiếp thị trực tuyến\t3\t2\t1\n10\tEC335\tAn toàn và bảo mật Thương mại điện tử\t3\t3\t0\n11\tIS336\tHoạch định nguồn lực doanh nghiệp\t4\t3\t1\n12\tIS207\tPhát triển ứng dụng Web\t4\t3\t1\n13\tEC331\tQuản trị chiến lược kinh doanh điện tử\t3\t3\t0\n14\tEC003\tTiếp thị căn bản\t3\t3\t0\n\nCụ thể, sự nâng cao đó được thể hiện qua các nội dung sau:\n- Hệ hỗ trợ quyết định\n\nChuẩn đầu ra | Mức độ trong chương trình đại trà | Mức độ trong chương trình CLC | Giải trình sự khác biệt với giảng dạy chương trình chính quy\n------- | -------- | -------- | --------\n2.2.11 Kiến thức hệ hỗ trợ ra quyết định | 3 | 4 | Thực hành xây dựng nhiều loại mô hình hệ hỗ trợ ra quyết định đáp ứng nhu cầu thực tiễn hơn\n7.3 Quản lý tiến trình hoạt động của nhóm | 2 | 3 | Tổ chức nhóm làm bài thực hành, đồ án môn học nhiều hơn\n9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh) | 1 | 3 | Giảng dạy bằng song ngữ\n\n\n**BẢN CHÉP LẠI BẢNG:**\n\n| STT | Mã môn | Tên môn | Mức độ trong chương trình đại trà | Mức độ trong chương trình CLC |\n|---|---|---|---|---|\n| 4 | IS210 | Hệ quản trị CSDL | 4 | 3 |\n| 5 | IS252 | Khai thác dữ liệu | 4 | 3 |\n| 6 | NT118 | Phát triển ứng dụng trên thiết bị di động | 3 | 2 |\n| 7 | IS403 | Phân tích dữ liệu kinh doanh | 3 | 3 |\n| 8 | IS334 | Thương mại điện tử | 3 | 3 |\n| 9 | EC311 | Tiếp thị trực tuyến | 3 | 2 |\n| 10 | EC335 | An toàn và bảo mật Thương mại điện tử | 3 | 3 |\n| 11 | IS336 | Hoạch định nguồn lực doanh nghiệp | 4 | 3 |\n| 12 | IS207 | Phát triển ứng dụng Web | 4 | 3 |\n| 13 | EC331 | Quản trị chiến lược kinh doanh điện tử | 3 | 3 |\n| 14 | EC003 | Tiếp thị căn bản | 3 | 3 |\n\n\n**MÔ TẢ HÌNH ẢNH HOẶC BIỂU ĐỒ:**\n\nKhông có hình ảnh hoặc biểu đồ nào trong tài liệu được cung cấp.\n"
        },
        {
            "PageNumber": 13,
            "ImagePath": "app/static/images/page_13.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\n9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh)\n\n- Hệ quản trị CSDL\n\n| Chuẩn đầu ra | Mức độ trong chương trình đại trà | Mức độ trong chương trình CLC | Giải trình sự khác biệt với giảng dạy chương trình chính quy |\n|---|---|---|---|\n| 2.1.5 Kiến thức quản lý thông tin | 3 | 4 | Thực hành nhiều bài tập tối ưu hóa câu lệnh truy vấn và hệ quản trị CSDL |\n| 7.3 Quản lý tiến trình hoạt động của nhóm | 2 | 3 | Tổ chức nhóm làm bài thực hành, đồ án môn học nhiều hơn |\n| 9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh) | 1 | 3 | Giảng dạy bằng tiếng Anh |\n| 9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh) | 1 | 3 | Tài liệu giảng dạy bằng tiếng Anh |\n\n- Khai thác dữ liệu\n\n| Chuẩn đầu ra | Mức độ trong chương trình đại trà | Mức độ trong chương trình CLC | Giải trình sự khác biệt với giảng dạy chương trình chính quy |\n|---|---|---|---|\n| 2.2.10 Kiến thức về khai thác dữ liệu | 3 | 4 | Tiếp cận nhiều vấn đề thực tiễn và bài toán thực tiễn trong lĩnh vực khai thác dữ liệu từ các chuyên gia đầu ngành |\n| 7.3 Quản lý tiến trình hoạt động của nhóm | 2 | 3 | Tổ chức nhóm làm bài thực hành, đồ án môn học nhiều hơn |\n| 9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh) | 1 | 3 | Giảng dạy bằng tiếng Anh |\n| 9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh) | 1 | 3 | Tài liệu giảng dạy bằng tiếng Anh |\n\n- Phát triển ứng dụng trên thiết bị di động\n"
        },
        {
            "PageNumber": 14,
            "ImagePath": "app/static/images/page_14.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\nChuẩn đầu ra | Mức độ trong chương trình đại trà | Mức độ trong chương trình CLC | Giải trình sự khác biệt với giảng dạy chương trình chính quy\n------- | -------- | -------- | --------\n2.2.8 Kiến thức lập trình trên thiết bị di động | 3 | 4 | Phát triển nhiều loại ứng dụng trên TBDĐ, tiếp cận nhiều cách gỡ lỗi, nhiều nền tảng phát triển ứng dụng trên di động tiên tiến.\n7.3 Quản lý tiến trình hoạt động của nhóm | 2 | 3 | Tổ chức nhóm làm bài thực hành, đồ án môn học nhiều hơn\n9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh) | 1 | 3 | Giảng dạy bằng tiếng Anh\n9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh) | 1 | 3 | Tài liệu giảng dạy bằng tiếng Anh\n\n**BẢN CHÉP LẠI VĂN BẢN:**\n\n- Phân tích dữ liệu kinh doanh\n\nChuẩn đầu ra | Mức độ trong chương trình đại trà | Mức độ trong chương trình CLC | Giải trình sự khác biệt với giảng dạy chương trình chính quy\n------- | -------- | -------- | --------\n2.2.17 Kiến thức phân tích dữ liệu kinh doanh | 3 | 4 | Thực hành nhiều bài tập phân tích các dữ liệu thực tiễn trong kinh doanh\n7.3 Quản lý tiến trình hoạt động của nhóm | 2 | 3 | Tổ chức nhóm làm bài thực hành, đồ án môn học nhiều hơn\n9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh) | 1 | 3 | Giảng dạy bằng tiếng Anh\n9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh) | 1 | 3 | Tài liệu giảng dạy bằng tiếng Anh\n\n**BẢN CHÉP LẠI VĂN BẢN:**\n\n- Thương mại điện tử\n\nChuẩn đầu ra | Mức độ trong chương trình đại trà | Mức độ trong chương trình CLC | Giải trình sự khác biệt với giảng dạy chương trình chính quy\n------- | -------- | -------- | --------\n\n\n**MÔ TẢ HÌNH ẢNH HOẶC BIỂU ĐỒ:** Không có hình ảnh hoặc biểu đồ trong tài liệu đã cung cấp.\n\n**BẢN CHÉP LẠI BẢNG:** Có ba bảng trong tài liệu đã cung cấp, tất cả đều được sao chép lại ở trên."
        },
        {
            "PageNumber": 15,
            "ImagePath": "app/static/images/page_15.png",
            "PageText": "**SAO CHÉP VĂN BẢN:**\n\n2.2.2 Kiến thức thương mại điện tử\n7.3 Quản lý tiến trình hoạt động của nhóm\n9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh)\n9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh)\n\n- Tiếp thị trực tuyến\n2.2.4 Kiến thức tiếp thị căn bản và trực tuyến\n7.3 Quản lý tiến trình hoạt động của nhóm\n9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh)\n9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh)\n\n- An toàn và bảo mật Thương mại điện tử\n\n\n**SAO CHÉP BẢNG:**\n\n| Chuẩn đầu ra | Mức độ trong chương trình đại trà | Mức độ trong chương trình CLC | Giải trình sự khác biệt với giảng dạy chương trình chính quy |\n|---|---|---|---|\n| 2.2.2 Kiến thức thương mại điện tử | 3 | 4 | Bổ sung cập nhật các mô hình kinh doanh đang sinh ra nhiều lợi nhuận, các mô hình tiên tiến trong và ngoài nước từ các giảng viên có kinh nghiệm thực tiễn bên ngoài. |\n| 7.3 Quản lý tiến trình hoạt động của nhóm | 2 | 3 | Tổ chức nhóm làm bài thực hành, đồ án môn học nhiều hơn |\n| 9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh) | 1 | 3 | Giảng dạy bằng tiếng Anh |\n| 9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh) | 1 | 3 | Tài liệu giảng dạy bằng tiếng Anh |\n| 2.2.4 Kiến thức tiếp thị căn bản và trực tuyến | 3 | 4 | Cập nhật các kiến thức nâng cao về cách chạy những chiến lược tiếp thị trực tuyến trong thực tiễn theo case study. Do các giảng viên có kinh nghiệm bên ngoài giảng dạy. |\n| 7.3 Quản lý tiến trình hoạt động của nhóm | 2 | 3 | Tổ chức nhóm làm bài thực hành, đồ án môn học nhiều hơn |\n| 9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh) | 1 | 3 | Giảng dạy bằng tiếng Anh |\n| 9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh) | 1 | 3 | Tài liệu giảng dạy bằng tiếng Anh |\n\n\nKhông có biểu đồ nào trong hình ảnh được cung cấp."
        },
        {
            "PageNumber": 16,
            "ImagePath": "app/static/images/page_16.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\n2.2.13 Kiến thức an toàn và bảo mật TMĐT\n7.3 Quản lý tiến trình hoạt động của nhóm\n9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh)\n9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh)\n\n- Hoạch định nguồn lực doanh nghiệp\n2.2.15 Kiến thức hoạch định nguồn lực doanh nghiệp\n7.3 Quản lý tiến trình hoạt động của nhóm\n9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh)\n9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh)\n\n- Phát triển ứng dụng Web\n2.2.7 Kiến thức lập trình trên nền tảng web\n\n**BẢN CHÉP LẠI BẢNG:**\n\n|                        | Mức độ trong chương trình đại trà | Mức độ trong chương trình CLC | Giải trình sự khác biệt với giảng dạy chương trình chính quy                                                                                                                                                              |\n| :--------------------- | :-------------------------------- | :------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| 2.2.13                | 3                                  | 4                                | Sinh viên được bổ sung các bài tập, thực hành về các tình huống tần công từ chối dịch vụ, sự xuất xuất hiện của các xu hướng công nghệ mới lên An toàn thông tin trong TMĐT                               |\n| 7.3                    | 2                                  | 3                                | Tổ chức nhóm làm bài thực hành, đồ án môn học nhiều hơn                                                                                                                                                             |\n| 9.1                    | 1                                  | 3                                | Giảng dạy bằng song ngữ                                                                                                                                                                                            |\n| 9.2                    | 1                                  | 3                                | Tài liệu giảng dạy bằng tiếng Anh                                                                                                                                                                                        |\n| 2.2.15                | 3                                  | 4                                | Sinh viên được cập nhật các ví dụ thực tiễn trong việc xây dựng triển khai các hệ thống ERP trong doanh nghiệp                                                                                               |\n| 7.3                    | 2                                  | 3                                | Tổ chức nhóm làm bài thực hành, đồ án môn học nhiều hơn                                                                                                                                                             |\n| 9.1                    | 1                                  | 2                                | Giảng dạy bằng song ngữ                                                                                                                                                                                            |\n| 9.2                    | 1                                  | 3                                | Tài liệu giảng dạy bằng tiếng Anh                                                                                                                                                                                        |\n| 2.2.7                 | 3                                  | 4                                | Sinh viên được bổ sung các xu hướng phát triển web cùng các framework mới trên thế giới.                                                                                                                         |\n\n\n**MÔ TẢ HÌNH ẢNH HOẶC BIỂU ĐỒ:**\n\nKhông có hình ảnh hoặc biểu đồ trong văn bản đã cung cấp.\n"
        },
        {
            "PageNumber": 17,
            "ImagePath": "app/static/images/page_17.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\n7.3 Quản lý tiến trình hoạt động của nhóm\n9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh)\n9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh)\nQuản trị chiến lược kinh doanh điện tử\nTiếp thị căn bản\n\n**BẢN CHÉP LẠI BẢNG:**\n\n| Chuẩn đầu ra | Mức độ trong chương trình đại trà | Mức độ trong chương trình CLC | Giải trình sự khác biệt với giảng dạy chương trình chính quy |\n|---|---|---|---|\n| 7.3 Quản lý tiến trình hoạt động của nhóm | 2 | 3 | Tổ chức nhóm làm bài thực hành, đồ án môn học nhiều hơn |\n| 9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh) | 1 | 2 | Giảng dạy bằng tiếng Anh |\n| 9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh) | 1 | 3 | Tài liệu giảng dạy bằng tiếng Anh |\n| 2.2.16 Kiến thức chiến lược kinh doanh điện tử | 3 | 4 | Cập nhật các chiến lược kinh doanh mới nhất trong TMĐT, các ví dụ thực tiễn từ các chuyên gia đầu ngành |\n| 7.3 Quản lý tiến trình hoạt động của nhóm | 2 | 3 | Tổ chức nhóm làm bài thực hành, đồ án môn học nhiều hơn |\n| 9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh) | 1 | 2 | Giảng dạy bằng song ngữ |\n| 9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh) | 1 | 3 | Tài liệu giảng dạy bằng tiếng Anh |\n| 2.2.4 Kiến thức tiếp thị căn bản và trực tuyến | 3 | 4 | Thực hành các chiến lược tiếp thị mới nhất từ các chuyên gia đầu ngành |\n| 7.3 Quản lý tiến trình hoạt động của nhóm | 2 | 3 | Tổ chức nhóm làm bài thực hành, đồ án môn học nhiều hơn |\n\n**MÔ TẢ HÌNH ẢNH HOẶC BIỂU ĐỒ:**\n\nKhông có hình ảnh hoặc biểu đồ nào trong hình ảnh đã cung cấp."
        },
        {
            "PageNumber": 18,
            "ImagePath": "app/static/images/page_18.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\n9.1 Kỹ năng giao tiếp nghe, nói, đọc viết tổng quát (Tiếng Anh)\n9.2 Kỹ năng đọc hiểu tài liệu chuyên môn bằng ngoại ngữ (Tiếng Anh)\n\n3. Kế hoạch giảng dạy\nĐây là kế hoạch giảng dạy mẫu. Tùy điều kiện thực tế, một số môn có thể được mở hoặc không được mở, cập nhật theo đề nghị của khoa quản lý ngành.\n\nKế hoạch giảng dạy giống chương trình chính quy đại trà nhưng có thêm 02 môn Anh Văn 4 và Anh Văn 5 được giảng dạy trong Học kỳ 4 và Học kỳ 5 như sau:\n\n\n**BẢN CHÉP LẠI BẢNG:**\n\n| Mã môn | Tên môn | TC | LT | TH | % TH/TC |\n|---|---|---|---|---|---|\n| IT001 | Nhập môn lập trình | 4 | 3 | 1 | 25% |\n| MA006 | Giải tích | 4 | 4 | 0 | 0% |\n| MA003 | Đại số tuyến tính | 3 | 3 | 0 | 0% |\n| EC005 | Giới thiệu ngành Thương mại điện tử | 1 | 1 | 0 | 0% |\n| ENG01 | Anh văn 1 | 4 | 4 | 0 | 0% |\n| PE012 | Giáo dục thể chất |  |  |  |  |\n| ME001 | Giáo dục quốc phòng |  |  |  |  |\n|  | **Tổng số tín chỉ HK1** | **16** | **15** | **1** |  |\n"
        },
        {
            "PageNumber": 19,
            "ImagePath": "app/static/images/page_19.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\nHọc kỳ 2\nIT002 Lập trình hướng đối tượng 4 3 1 25%\nIT003 Cấu trúc dữ liệu và giải thuật 4 3 1 25%\nEC001 Kinh tế học đại cương 4 4 0 0%\nSS004 Kỹ năng nghề nghiệp 2 2 0 0%\nENG02 Anh văn 2 4 4 0 0%\nTổng số tín chỉ HK2 18 16 2\n\nHọc kỳ 3\nIT004 Cơ sở dữ liệu 4 3 1 25%\nIT005 Nhập môn mạng máy tính 4 3 1 25%\nMA004 Cấu trúc rời rạc 4 4 0 0%\nMA005 Xác suất thống kê 3 3 0 0%\nENG03 Anh văn 3 4 4 0 0%\nTổng số tín chỉ HK3 19 17 2\n\nGIAI ĐOẠN II: 81 TC\nMã môn Tên môn TC LT TH\n\n\n\n**BẢN CHÉP LẠI BẢNG:**\n\n| Học kỳ | Mã môn | Tên môn | TC | LT | TH | % |\n|---|---|---|---|---|---|---|\n| 2 | IT002 | Lập trình hướng đối tượng | 4 | 3 | 1 | 25% |\n|  | IT003 | Cấu trúc dữ liệu và giải thuật | 4 | 3 | 1 | 25% |\n|  | EC001 | Kinh tế học đại cương | 4 | 4 | 0 | 0% |\n|  | SS004 | Kỹ năng nghề nghiệp | 2 | 2 | 0 | 0% |\n|  | ENG02 | Anh văn 2 | 4 | 4 | 0 | 0% |\n|  |  | **Tổng số tín chỉ HK2** | **18** | **16** | **2** |  |\n| 3 | IT004 | Cơ sở dữ liệu | 4 | 3 | 1 | 25% |\n|  | IT005 | Nhập môn mạng máy tính | 4 | 3 | 1 | 25% |\n|  | MA004 | Cấu trúc rời rạc | 4 | 4 | 0 | 0% |\n|  | MA005 | Xác suất thống kê | 3 | 3 | 0 | 0% |\n|  | ENG03 | Anh văn 3 | 4 | 4 | 0 | 0% |\n|  |  | **Tổng số tín chỉ HK3** | **19** | **17** | **2** |  |"
        },
        {
            "PageNumber": 20,
            "ImagePath": "app/static/images/page_20.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\nHọc kỳ 4\nSE104 Nhập môn công nghệ phần mềm\nIS334 Thương mại điện tử\nEC201 Phân tích thiết kế quy trình nghiệp vụ doanh nghiệp\nEC003 Tiếp thị căn bản\nSS009 Chủ nghĩa xã hội khoa học\nENG04 Anh văn 4\nTổng số tín chỉ HK4\n\nHọc kỳ 5\nIS207 Phát triển ứng dụng web\nEC213 Quản trị quan hệ khách hàng và nhà cung cấp\nSS003 Tư tưởng Hồ Chí Minh\nSS006 Pháp luật đại cương\nENG05 Anh văn 5\nTự chọn\nTổng số tín chỉ HK5\n\n\n**BẢN CHÉP LẠI BẢNG:**\n\n|          |                               |  |  |  |   |\n| :------- | :---------------------------- | :- | :- | :- | :- |\n| Học kỳ 4 | SE104                         | 4 | 3 | 1 | 25% |\n|          | IS334                         | 3 | 3 | 0 | 0%  |\n|          | EC201                         | 4 | 3 | 1 | 25% |\n|          | EC003                         | 3 | 3 | 0 | 0%  |\n|          | SS009                         | 2 | 2 | 0 | 0%  |\n|          | ENG04                         | 4 | 4 | 0 |     |\n|          | Tổng số tín chỉ HK4           | 20 | 18 | 2 |     |\n| Học kỳ 5 | IS207                         | 4 | 3 | 1 | 25% |\n|          | EC213                         | 3 | 2 | 1 | 33% |\n|          | SS003                         | 2 | 2 | 0 | 0%  |\n|          | SS006                         | 2 | 2 | 0 | 0%  |\n|          | ENG05                         | 4 | 4 | 0 |     |\n|          | Tự chọn                       | 4 | 4 | 0 | 0%  |\n|          | Tổng số tín chỉ HK5           | 19 | 17 | 2 |     |\n\n\n"
        },
        {
            "PageNumber": 21,
            "ImagePath": "app/static/images/page_21.png",
            "PageText": "**BẢN CHÉP LẠI VĂN BẢN:**\n\nEC311 | Tiếp thị trực tuyến | 3 | 2 | 1 | 33%\nEC312 | Thiết kế hệ thống thương mại điện tử | 3 | 2 | 1 | 33%\nEC208 | Quản trị dự án TMĐT | 3 | 3 | 0 | 0%\n**Học kỳ 6** EC335 | An toàn và bảo mật TMĐT | 3 | 3 | 0 | 0%\nSS007 | Triết học Mác - Lênin | 3 | 3 | 0 | 0%\nTự chọn | 3 | 3 | 0 | 0%\n**Tổng số tín chỉ HK6** | **18** | **16** | **2** |\nEC222 | Thực tập doanh nghiệp | 2 | 2 | 0 | 0%\nEC229 | Pháp luật trong thương mại điện tử | 2 | 2 | 0 | 0%\nEC337 | Hệ thống thanh toán trực tuyến | 3 | 3 | 0 | 0%\n**Học kỳ 7** SS008 | Kinh tế chính trị Mác - Lênin | 2 | 2 | 0 | 0%\nSS010 | Lịch sử Đảng Cộng sản Việt Nam | 2 | 2 | 0 | 0%\nTự chọn | 3 | 3 | 0 | 0%\n**Tổng số tín chỉ HK7** | **14** | **14** | **0** |\n**Học kỳ 8** EC401 | Khóa luận tốt nghiệp | 10 | 10 | 0 | 0%\n**Tổng số tín chỉ HK8** | **10** | **10** | **0** |\n\n**BẢN CHÉP LẠI BẢNG:**\nKhông có hình ảnh hoặc biểu đồ trong tài liệu này."
        }
    ]
}

# df = pd.DataFrame(test["response"])


@router.post("/upsert", response_model=dict)
async def upsert(body: UpsertRequest):
    documentId = body.documentId
    documentUrl = body.documentUrl
    metadata = body.metadata

    try:
        df = process_document(documentUrl)

        if df is None:
            raise ValueError("Document processing returned None")

        for idx, row in tqdm(df.iterrows(), total=df.shape[0], desc='Uploading to Pinecone'):
            pageNumber = row['PageNumber']

            new_metadata = {
                **metadata,  # Unpack the existing metadata dictionary
                'pageId': f"{documentId}-{pageNumber}",
                'pageNumber': pageNumber,
                'text': row['PageText'].replace('\n', ' ')
            }

            await upsert_vector(new_metadata['pageId'], new_metadata)

        return {
            "response": df.to_dict(orient="records"),
        }

    except Exception as e:
        raise HTTPException(
            status_code=500, detail=f"{str(e)}")
